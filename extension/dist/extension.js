(()=>{"use strict";var e={441:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SidebarProvider=void 0;const s=i(496),n=i(686);t.SidebarProvider=class{constructor(e){this._extensionUri=e,s.window.onDidChangeActiveTextEditor((e=>{e&&(this._doc=e.document)})),s.window.activeTextEditor&&(this._doc=s.window.activeTextEditor.document)}resolveWebviewView(e){this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[this._extensionUri]},e.webview.html=this._getHtmlForWebview(e.webview),e.webview.onDidReceiveMessage((async e=>{switch(e.type){case"replace-in-file":{const t=s.window.activeTextEditor;let i=!1;if(t){const n=t.document,o=t.selection,r=new s.WorkspaceEdit;r.replace(n.uri,o,e.value),await s.workspace.applyEdit(r),i=!0}else s.window.showErrorMessage("No file open");break}case"get-file-contents":{const e=s.window.activeTextEditor;let t="";e&&(t=e.document.getText()),this._view?.webview.postMessage({type:"file-contents",value:t});break}case"get-selection":{const e=s.window.activeTextEditor;let t="",i=0;if(e){const s=e.selection;t=e.document.getText(s),i=s.start.line+1}this._view?.webview.postMessage({type:"selection-change",value:t,start_line:i});break}case"run-code":s.commands.executeCommand("peritus.runCode");break;case"open-settings":s.commands.executeCommand("workbench.action.openSettings","@ext:peritus.peritus");case"get-settings":{const e=s.workspace.getConfiguration("peritus");this._view?.webview.postMessage({type:"settings",value:e})}case"onInfo":if(!e.value)return;s.window.showInformationMessage(e.value);break;case"onError":if(!e.value)return;s.window.showErrorMessage(e.value)}}))}revive(e){this._view=e}_getHtmlForWebview(e){const t=e.asWebviewUri(s.Uri.joinPath(this._extensionUri,"media","reset.css")),i=e.asWebviewUri(s.Uri.joinPath(this._extensionUri,"media","vscode.css")),o=e.asWebviewUri(s.Uri.joinPath(this._extensionUri,"media","prism.css")),r=e.asWebviewUri(s.Uri.joinPath(this._extensionUri,"out","compiled/sidebar.js")),a=e.asWebviewUri(s.Uri.joinPath(this._extensionUri,"out","compiled/sidebar.css")),c=(0,n.default)();return`<!DOCTYPE html>\n\t\t\t<html lang="en">\n\t\t\t<head>\n\t\t\t\t<meta charset="UTF-8">\n\t\t\t\t\x3c!--\n\t\t\t\t\tUse a content security policy to only allow loading images from https or from our extension directory,\n\t\t\t\t\tand only allow scripts that have a specific nonce.\n        --\x3e\n\t\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <meta http-equiv="Content-Security-Policy" content="img-src https: data:; style-src 'unsafe-inline' ${e.cspSource}; script-src 'nonce-${c}';">\n\t\t\t\t<link href="${t}" rel="stylesheet">\n\t\t\t\t<link href="${i}" rel="stylesheet">\n        <link href="${o}" rel="stylesheet">\n        <link href="${a}" rel="stylesheet">\n        <script nonce="${c}">\n          const tsvscode = acquireVsCodeApi();\n        <\/script>\n\t\t\t</head>\n      <body>\n\t\t\t\t<script nonce="${c}" src="${r}" ><\/script>\n\t\t\t</body>\n\t\t\t</html>`}}},686:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<32;i++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}},496:e=>{e.exports=require("vscode")}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}var s={};(()=>{var e=s;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=i(496),n=i(441);e.activate=function(e){const i=new n.SidebarProvider(e.extensionUri);e.subscriptions.push(t.window.registerWebviewViewProvider("peritus-sidebar",i)),e.subscriptions.push(t.commands.registerCommand("peritus.refresh",(async()=>{await t.commands.executeCommand("workbench.action.closeSidebar"),await t.commands.executeCommand("workbench.view.extension.peritus-ai-sidebar-view")}))),e.subscriptions.push(t.window.onDidChangeTextEditorSelection((()=>{const{activeTextEditor:e}=t.window;if(!e)return;const s=e.selection,n=e.document.getText(s),o=s.start.line+1;i._view?.webview.postMessage({type:"selection-change",value:n,start_line:o})}))),e.subscriptions.push(t.commands.registerCommand("peritus.runCode",(async()=>{const e=t.window.activeTextEditor;if(!e)return void t.window.showWarningMessage("No active text editor found. Please open a file to run.");const i=e.document.fileName,s=new t.Task({type:"peritus"},t.TaskScope.Workspace,"Run Code","Peritus",new t.ShellExecution(`python3 "${i}"`));s.group=t.TaskGroup.Build,s.problemMatchers=["$eslint-stylish"],await t.tasks.executeTask(s)}))),t.tasks.onDidEndTaskProcess((async e=>{if("Run Code"===e.execution.task.name){const t=0!==e.exitCode;i._view?.webview.postMessage({type:"code-run",value:t})}}))},e.deactivate=function(){}})(),module.exports=s})();